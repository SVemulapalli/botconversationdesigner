<!DOCTYPE HTML>
<html>
<head>
    <title>Bot Conversation Designer</title>
    <meta charset="UTF-8"/>
<style>
</style>
    <link href="css/style.css" rel="stylesheet" />
    <link href="https://cdn.botframework.com/botframework-webchat/latest/botchat.css" rel="stylesheet" />
    <script src="js/go.js"></script>
    <script src="js/diagram.js"></script>
    <script src="js/activities.js"></script>
    <script src="js/offlinebotchat.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body onload="init()">
    <div id="header"><b>bot</b>conversation<b>designer</b></div>
    <style>button {border: 1px solid gray;padding:5px;cursor: pointer;}</style>
    <div style="position:absolute;top:24px;left:350px">
        <button onclick="menu.new()">New</button>
        <button onclick="menu.save()">Save</button>
        <button onclick="menu.load()">Load</button><input type="file" id="fileToLoad" style="display:none">
        <button onclick="menu.PlayStep()">Play From Step</button>
        <button onclick="menu.exportCsharp()" style="margin-left: 20px;">Export to C#</button>
        <button onclick="menu.exportNodejs()">Export to Node</button>
    </div>
<div id="main">
        <div id="left" class="panel">
            <div id="botWC" class=largeChild></div>
        </div>
        <div id="center" class="panel">
            <div class=largeChild style="position:relative">
                <div class=wc-header><span style="font-size:15px">Designer</span></div>
                <div id="godiag">
                    <div id="myPaletteDiv"></div>
                    <div id="myDiagramDiv"></div>
                </div>
            </div>
        </div>
        <div id="right" class="panel">
            <div class=largeChild style="position:relative">
                <div class=wc-header><span style="font-size:15px">Properties</span></div>
                <div style="padding-top:60px;" id=propList></div>
        
                <textarea id="mySavedModel" style="display:none;width:100%;height:300px">{ "class": "go.GraphLinksModel","linkFromPortIdProperty": "fromPort","linkToPortIdProperty": "toPort","nodeDataArray": [],"linkDataArray": []}    </textarea>
        
                <div style="position:absolute;bottom:0px;width:190px;overflow-y:scroll;height:100px">
                    <b>STACK VALUE</b>
                    <div id=userdatavalue style="width:165px;word-wrap: break-word;">
                        <i>empty</i>
                    </div>
                </div>
               
            </div>
        </div>
    </div>
    <div id="footer">2019 Luis Alves Martins - <a href="http://github.com/luisalvesmartins">http://github.com/luisalvesmartins</a></div>

    <script>
var DirectLineEmulator;        
function init()
{
      const user = {
        id: 'Luis',
        name: 'Luis'
      };
      const bot = {
        id: 'botid',
        name: 'botname'
      };

      BotChat.App({
        bot: bot,
        user: user,
        botConnection: new BotChat.DirectLine({}),
        //to disable user shell
        //disabled:true
      }, document.getElementById('botWC'));

    DirectLineEmulator={
      emptyActivity:{
          "activities": [],
          "watermark": "0"
      },
      userActivity:function(activity){
      //Every time the user sends an activity: 
          Bot.receiveMessage(activity);
      },
      getActivity:function(activity){
      //The bot polls this function every 1000ms, change activity to the message you want to display
          //console.log("ACTIVITY SENT")
          return this.emptyActivity;
      }
    }
    goDiagram();
    $('#fileToLoad').change(menu.handleFileSelect);

    //LOAD INITIAL BOT
    var model={"flow":[{"key":"1","text":"I am the Echo Bot Sample","type":"START","next":[{"to":-2,"text":""}]},{"key":-2,"text":"Please shout something","type":"INPUT","next":[{"to":-5,"text":""}],"parVar":"SHOUT","parTyp":"","parCkv":"Yes"},{"key":-5,"text":"You said: {SHOUT}","type":"MESSAGE","next":[{"to":-4,"text":""}]},{"key":-4,"text":"Check if you are saying ECHO","type":"IF","next":[{"to":-6,"text":"true"},{"to":-2,"text":"false"}],"parCon":"\"{SHOUT}\"==\"ECHO\""},{"key":-6,"text":"ECHO... ECHO... ECHO...","type":"MESSAGE","next":[{"to":-7,"text":""}]},{"key":-7,"text":"Choose a color using natural language (LUIS)","type":"LUIS","next":[{"to":-8,"text":"blue_intent"},{"to":-9,"text":"red_intent"},{"to":-10,"text":"None"}],"parVar":"LUISVAR","parURL":"https://westus.api.cognitive.microsoft.com/luis/v2.0/apps/","parKey":"914db407-b188-442c-8306-c9cb781faadc?subscription-key=c6e72331a84c4d23a590c503c360c35b","parLMI":"0.5"},{"key":-8,"text":"Blue: nice color!","type":"MESSAGE","next":[{"to":-2,"text":""}]},{"key":-9,"text":"Red: nice color!","type":"MESSAGE","next":[{"to":-2,"text":""}]},{"key":-10,"text":"I couldn't figure it out so you can play with QNAMaker","type":"MESSAGE","next":[{"to":-11,"text":""}]},{"key":-11,"text":"Chitchat with me (EXIT to leave)","type":"QNA","next":[{"to":-12,"text":""}],"parVar":"QNA","parURL":"https://lambotengineqna.azurewebsites.net/qnamaker","parKey":"b8fb0e89-daeb-46f0-9a23-3762df2080a3","parPar":"b99d3036-03b3-41c0-98dd-6c90a7aee95c"},{"key":-12,"text":"is EXIT?","type":"IF","next":[{"to":-2,"text":"true"},{"to":-11,"text":"false"}],"parCon":"\"{QNA}\"==\"EXIT\""}],"diagram":{"class":"go.GraphLinksModel","modelData":{"position":"2.068576174552085 10.504361795824621"},"nodeDataArray":[{"text":"I am the Echo Bot Sample","figure":"Circle","fill":"#00AD5F","type":"START","key":"1","loc":"148.50436179582462 63.50436179582462","size":"106 96"},{"text":"Please shout something","type":"INPUT","key":-2,"loc":"140 160","parVar":"SHOUT","parTyp":"","parCkv":"Yes"},{"text":"You said: {SHOUT}","figure":"RoundedRectangle","fill":"lightyellow","type":"MESSAGE","key":-5,"loc":"140 260"},{"text":"Check if you are saying ECHO","figure":"Diamond","fill":"lightskyblue","type":"IF","key":-4,"loc":"140 380","size":"210 129","parCon":"\"{SHOUT}\"==\"ECHO\""},{"text":"ECHO... ECHO... ECHO...","figure":"RoundedRectangle","fill":"lightyellow","type":"MESSAGE","key":-6,"loc":"390 470"},{"text":"Choose a color using natural language (LUIS)","figure":"RoundedRectangle","fill":"lightgreen","type":"LUIS","key":-7,"loc":"390 370","parVar":"LUISVAR","parURL":"https://westus.api.cognitive.microsoft.com/luis/v2.0/apps/","parKey":"914db407-b188-442c-8306-c9cb781faadc?subscription-key=c6e72331a84c4d23a590c503c360c35b","parLMI":"0.5"},{"text":"Blue: nice color!","figure":"RoundedRectangle","fill":"lightyellow","type":"MESSAGE","key":-8,"loc":"300 210"},{"text":"Red: nice color!","figure":"RoundedRectangle","fill":"lightyellow","type":"MESSAGE","key":-9,"loc":"470 210"},{"text":"I couldn't figure it out so you can play with QNAMaker","figure":"RoundedRectangle","fill":"lightyellow","type":"MESSAGE","key":-10,"loc":"600 350"},{"text":"Chitchat with me (EXIT to leave)","figure":"RoundedRectangle","fill":"#77CC77","type":"QNA","key":-11,"loc":"630 250","parVar":"QNA","parURL":"https://lambotengineqna.azurewebsites.net/qnamaker","parKey":"b8fb0e89-daeb-46f0-9a23-3762df2080a3","parPar":"b99d3036-03b3-41c0-98dd-6c90a7aee95c"},{"text":"is EXIT?","figure":"Diamond","fill":"lightskyblue","type":"IF","key":-12,"loc":"620 160","parCon":"\"{QNA}\"==\"EXIT\""}],"linkDataArray":[{"from":"1","to":-2,"points":[143.50436179582462,111.50436179582462,143.50436179582462,121.50436179582462,143.50436179582462,128.0021808979123,140,128.0021808979123,140,134.5,140,144.5]},{"from":-2,"to":-5,"points":[140,175.5,140,185.5,140,208.61928812542303,140,208.61928812542303,140,231.73857625084605,140,241.73857625084605]},{"from":-5,"to":-4,"points":[140,278.26142374915394,140,288.26142374915394,140,296.88071187457706,140,296.88071187457706,140,305.5000000000001,140,315.5000000000001]},{"from":-4,"to":-6,"points":[245,380,255,380,276.45928827801094,380,276.45928827801094,470.00000000000005,297.91857655602183,470.00000000000005,307.91857655602183,470.00000000000005],"text":"true"},{"from":-6,"to":-7,"points":[390,451.7385762508461,390,441.7385762508461,390,423.25,390,423.25,390,404.76142374915394,390,394.76142374915394]},{"from":-4,"to":-2,"points":[35,380.0000000000001,25,380.0000000000001,25,160,38.50250244140625,160,52.0050048828125,160,62.0050048828125,160],"text":"false"},{"from":-7,"to":-8,"points":[390,345.238576250846,390,335.238576250846,390,286.75,300,286.75,300,238.26142374915395,300,228.26142374915395],"text":"blue_intent"},{"from":-7,"to":-9,"points":[390,345.238576250846,390,335.238576250846,390,286.75,470,286.75,470,238.26142374915395,470,228.26142374915395],"text":"red_intent"},{"from":-8,"to":-2,"points":[241.24357731896126,210,231.24357731896126,210,229.61928621807436,210,229.61928621807436,160,227.9949951171875,160,217.9949951171875,160]},{"from":-9,"to":-2,"points":[412.90857823448863,210,402.90857823448863,210,402.90857823448863,210,402.90857823448863,160,227.9949951171875,160,217.9949951171875,160]},{"from":-7,"to":-10,"points":[469.08642069739613,370,479.08642069739613,370,493.7949981689453,370,493.7949981689453,350,508.50357564049443,350,518.5035756404944,350],"text":"None"},{"from":-10,"to":-11,"points":[600,318.73857625084605,600,308.73857625084605,600,296.75,630,296.75,630,284.76142374915394,630,274.76142374915394]},{"from":-11,"to":-12,"points":[630,225.23857625084602,630,215.23857625084602,630,207.619288125423,620,207.619288125423,620,200,620,190]},{"from":-12,"to":-2,"points":[555.6800003051758,160,545.6800003051758,160,386.83749771118164,160,386.83749771118164,160,227.9949951171875,160,217.9949951171875,160],"text":"true"},{"from":-12,"to":-11,"points":[684.3199996948242,160,694.3199996948242,160,724.0814234439781,160,724.0814234439781,205,724.0814234439781,250,714.0814234439781,250],"text":"false"}]}};
    myDiagram.model = go.Model.fromJson(model.diagram);
    LoadAndSave.loadDiagramProperties();
    Bot.userData={};
    myDiagram.select(myDiagram.findNodeForKey("1"));
    menu.PlayStep();

}        
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135656500-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-135656500-1');
</script>
</body>
</html>